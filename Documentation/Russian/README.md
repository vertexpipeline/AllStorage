# AllStorage
### Основные главы документации

 - Описание
 - Архитектура
 - Расширения

## Описание
#### Проблема
Каждый день мы переносим файлы между устройствами, но не каждый имеет стабильное подключение к интернету чтобы использовать такие онлайн хранилища как Google.Drive, Yandex.Disk и другие. Поэтому самым простым решением этой проблемы является использование flash-накопителей, которые нельзя использовать с мобильными телефонами, отправлять сразу всем получателем, и каждый их них имеет довольно ограниченную скорость.
#### Решение
Для решения этой проблемы мы решили сделать единый сервер, который устанавливается на любое устройстве с подключением к локальной сети(то есть даже телефон может быть сервером), далее на каждое устройство устанавливается клиент, который не требует никакой настройки*. Теперь вы можете хранить ваши файлы на сервере, имея скорость передачи данных на пределе аппаратных возможностей:
##### __Теоретическая скорость передачи**__
Способ передачи | Скорость записи
------------ | -------------
Flash-накопители | 240 МБит/с
Онлайн харнилища | 1 - 30 МБит/с (В зависимости от соединения)
AllStorage | **1000-10000** МБит/с (В зависимости от оборудования)


----------
###### *В сложных сетях может потребоваться указать диапазон сканирования
###### **Скорость, рассчитанная на теоретическом максимуме задействованных компонентов


----------
#### Пакеты
Из [опроса](https://goo.gl/forms/10qPnTNoZTmxBY263) стало ясно, что пользователи обмениваются файлами довольно часто: ![вырезка](https://pp.userapi.com/c840220/v840220658/1a1f7/kFLXdRPoQFc.jpg)
Поэтому создали систему пакетов - они как архивы, только у них есть срок жизни. По его истечению они архивируются и больше не мешают вам. 
#### Адаптеры
Самой интересной частью проекта является объединение множества хранилищ:![enter image description here](https://pp.userapi.com/c840220/v840220511/186b1/Mpp9Vnuc3Gw.jpg)


Вы можете подключить различные адаптеры для Google.Drive, Yandex.Disk, Dropbox и так далее, в конечном счете все клиент буду получать файлы со всех хранилищ. Одинаковые файлы будут сравниваться во времени их создания, что поможет определять версии файлов. 

#### Синхронизация
Для того, чтоб обмениваться файлами между внутренними сетями, можно синхронизировать файлы на хранилищах(даже сервисах) или выбирать в каком их них хранить отправляемые данные.

#### Скорость работы
Так как для работы требуется клиент, то у нас отрываются огромные возможности для улучшения удобности сервиса. К примеру для отправки на сервер данных из буфера обмена требуется лишь нажать `Shift`+`Ctrl`+`V`. 

## Архитектура
Данный раздел покажет, как это все работает "за кулисами".

![enter image description here](https://pp.userapi.com/c836433/v836433023/4e872/hDpuIEDIOPM.jpg) 

#### Серверная часть
Все клиенты подключаются к одному серверу, расположенному на одном из адрессов локальной сети (меняется в настройках, но в большинстве случаев найдет автоматически), который выполняет обьединяющую функцию - он получае запросы от клиентов, и отправляет их на хранилища или же к другим серверам (слева), которые в своб очередь возвращают все найденные файлы по данному пути. Это просходит с помощью HTTP запросов к RESTful сервису, который их обрабатывает. Как язык для написания всех серверов я использовал C#, один их самых развивающихся языков, тем более он имеет важную особенность - поддержка подгрузки расширений по методу рефлексии. Это дает возможно разрабатывать все адаптеры для хранилищ отдельно. Сами адаптеры являются отдельными библиотеками на С#, которые поставляют серверу единый интерфейс для взаимодействия с определенным хранилищем. Так для минимальной конфигурации потребуется:

 1. Клиент для любой платформы
 2. Сервер
 3. Адаптер для локального хранилища
 4. Локальное хранилище

Важной частью является само хранилище, которое так же является сервером. Появляется логичный вопрос:"Зачем оно работает отдельно?". Все просто. Не в каждом офисе есть сервер для хранения файлов. В этом случае гараздо проще распределить хранилища по нескольком машинам, которые никогда не выключаются и собрать их них своеобразный сервер. Так же это снизит общую нагрузку на сеть.
По сколько я использовал ASP.NET Core - это позволило разворачивать данную инфраструктуру на любой ОС.

#### Пользовательская часть
Для работы с сервером потребуются клиенты. Поэтому они должны быть для всех платформ. Для desktop-платформ я использую kotlin + JavaFX. Тем самым одно приложение работает на Windows, Linux и MacOS. 

#### Для разработчиков
Любой разработчки может использовать сервера для своих нужд используя REST API. Для добавления новых типов хранилищь можно использовать AllStorageToolKit, в который входит набор интерфейсов и классов для создания адаптеров.